so my name is Ken Weston and so today
I'm going to be talking about being a
professional cyber stalker I actually
founded a company called gadgettrak kind
of kind of fell into it I was sort of a
reluctant hacker and CEO and I actually
learned quite a bit along the way I
basically started developing very Steph
recovery tools to help recover stolen
devices I kind of got into also the
investigation side because the law
enforcement needed a lot of help and
I'll kind of talk about some of those
challenges and things I learned along
the way so I've actually assisted law
enforcement with the number
investigations and not just with the
tools I developed a lot of times they
would come to me for you know other tech
recovery tools and/or other data that
they may have and I'll kind of talk
about that to sort of you know how to
how to harvest information from social
media and other sources as well I'm not
with gadgettrak anymore I'm currently a
senior security analyst tripwire
catching a different type of criminal
and dealing with different types of data
but I still still get keep involved in
some of this stuff with some of the
investigations so for those of you into
some hardcore justice porn this is my
wall of shame these are actual cases
I've been involved with you'll see a lot
of photos taken by web cameras I blur
their faces out to protect the guilty
and some of these are also some of the
folks actually recovered devices for if
we didn't have photos of them from the
web camera so what's interesting is that
more than half the time when I went to
go recover a device the police would go
in and they would find other crimes were
committed a lot of times there were
fencing operations drugs they would find
people that actually had warrants for
other crimes even got involved with a
very violent carjacking and the laptop
sort of served as a Trojan to help us
identify and find the people that were
involved and also you know you know by
basically Trojan izing devices you know
itself becomes a Trojan providing
visibility into these larger criminal
enterprises and I'll go into some of the
details these cases throughout the
presentation so that being said you can
probably imagine some of the work I do
is do
have its critics it's usually from folks
who don't understand the intentions or
the background of the tools the fact is
there are incredibly there tools that
are much more invasive that are
available to do more nefarious things
such as rats a lot of malware out there
that people can use if they actually
want to spy on someone you know during
the process developing the tools I was
very concerned about how the tools might
be used and also concerned about privacy
actually investigating some of the other
theft recovery tools that were out there
I found a lot of them actually had
backdoors into the systems they would
actually gather more data than they
really needed and so I tried to develop
a tool that was both useful for law
enforcement investigations but also
balance the privacy implications as well
so I also found on mobile devices in
particular that applications gather a
lot more information than what I did and
I'll talk a little bit about that so a
lot of things that marketing
applications do are more scary than some
of the information that I would gather
for theft recovery purposes I got
started with this when I was working for
a company that was specializing in
blocking USB devices this was a long
time ago 2007-2008 my exposure at that
time to security was basically just as a
server administrator trying to secure
web servers and and managing the
websites and I got really interested and
actually how these USB based tools were
being used to compromise networks you
know hacking is hard you know trying to
access a network from outside is very
difficult but being a lazy hacker you
know using USB devices to compromise a
system or steal data it's a lot easier
so I started actually working with these
tools and I actually created a website
called USB hacks the way I actually
started posting some of the tools that
the community was developing started
working with some of these myself and it
was really interesting I started getting
some interesting inquiries from both
sides of the law that was the first time
the FBI gave me a little call but I
think once they understood my intentions
that this was more about raising
awareness because at that time nobody
was actually talking about this or
providing these tools and now you know
the least they had those tools to play
with so network administrators can
actually test their networks to see how
it would react to these particular tools
a lot of researchers actually still
asked for those tools so I actually put
the the URL there just below the title
so if you want to download those just be
careful most most should be picked up by
antivirus but you can still modify some
of the scripts and it'll still work so
you know after I brought it down I
thought about you know what what if I
was able to utilize these tools and
actually make them more friendly right
so instead of taking a Trojan and
actually causing damage what if we turn
that into a happy Trojan right so you
know the idea is is it very similar is
that you know you plug in a flash drive
utilize auto run capability you run a
binary and you're able to gather a lot
of information and you know you can do a
lot where you can grab hashes you can
grab all this stuff but for theft
recovery purposes I figured you know we
get the IP address we get the internal
network address we can do some
geolocation just off of the IP so we at
least know what city they're in but the
more useful information was the computer
name and then the username of the person
that actually is is using that system
and through that I launched this as a
free tool it was actually part of my
master's degree it's my system that I
built and I put it out there for free
and I was just kind of curious so people
be interested this I got on the homepage
of dig and they got dug to death it was
like 20,000 people registered over the
course of two to three days and as you
can imagine this was all coming into a
central server so it actually you can
actually activate tracking remotely and
then when the device gets connected
it'll then send data to the owner so I
was able to harvest a lot of information
about the devices that this was working
with and it was far beyond USB devices I
found it was working with external hard
drives GPS devices because that's how
you update the maps at the time it
worked with also the the iPods so if
they didn't have the right software all
the time and you plug in and one of
these iPods and you access it it would
actually get triggered as well which was
which was pretty interesting I've gone
ahead and I've you know put the the
actual
be client source-code at least one
version of it up here so if you guys get
the slides or you want to download it
it's in C++ but then here's the autorun
capability right so this was a massive
vulnerability that Microsoft put out
there and you know it's still it's still
present today
you know you'll even see systems that
are vulnerable in industrial
environments on healthcare and they're
still going to be running Windows XP and
they're still vulnerable to these types
of attacks and I'll kind of show some
examples of that too so you think that
this we would have learned by now that
USB devices are are bad but even at
blackhat this year a lot of people they
scattered a bunch of flash drives out
and they fell victim to it and had data
stolen from their systems I'm not sure
if it was innocent bystanders hopefully
wasn't you guys if it was one of you get
the hell out so one thing I learned is
that the trouble with getting the IP
address you know we talk a lot about
attribution you know this this attack
came from China well you know IP address
you know it's very very difficult to use
for attribution one thing I found is
that law enforcement don't like
paperwork that actually don't like doing
a lot of work so when you're dealing
with IP addresses they have to do a lot
of filing they have to go through to get
a court order to get that information
from an ISP you know some of this
process can take anywhere from two weeks
to three months it really depends on who
you're dealing with
it also doesn't it's not identity it
doesn't actually put the person in front
of the computer so you can go and you
can recover that it's like yeah that
wasn't me
I don't know what you're talking about
there's also you know it can help with
probable cause but it's increasingly
becoming a challenge to use IP address
for probable cause it's not always
accurate as well especially nowadays you
know you have mobile hotspots people at
Starbucks things like that so IP address
really isn't working very well and in
general it takes a really long time when
you're trying to recover a stolen device
it's it's a major hassle because time is
of the essence especially when these
devices are getting fenced so with this
though you know I had the first first
that I know the first ipod recovery and
it wasn't from my p address I was
getting a lot of these things where a
lot of kids were installing on their
iPod
and it was easy because a lot of times
these kids would steal it and then they
would go home and then they would plug
it in and then it would be the like the
kalapa gates family there's only one kid
that would had that last name so the
school was able to actually get the iPod
back further for those kids so it was
kind of fun and I think it was cool too
is that this time when we did this is
this the idea that if you steal
something it can be tracked so I like to
think that maybe that had a little bit
of an impact on people's wanting to
steal these devices and also through
this process when I learned all the
devices was working with I found it was
working with these high-end thermal
imaging cameras so I was actually
approached by a company to develop a
custom agent for them where we actually
would use this to protect these devices
that are around 3,000 to 300,000 dollars
and thermal imaging devices so it was a
very similar process the one thing with
this was that then they actually wrote
the images to an SD card so they're like
well what if someone takes out the SD
card you know so we actually wrote some
custom code in the firmware where when
it puts in a new SD card it'll actually
write a new agent back to the SD card so
even if you put a new one in it's still
going to going to block it what's really
interesting too is that they were just
just concerned about theft recovery but
also these devices are export controlled
and they were finding some of these
devices were ending up in countries that
they shouldn't be so that was another
sort of additional measures that they
wanted to take so if one of these
cameras ended up somewhere and was
connected to a computer in Iran for
example they would be able to map that
back to the reseller who actually sold
it to them and so with this too is that
I disguised and the other agents I
disguise the agent as a passwords file
on this one i disguised it as a thermal
image of a cat mural so this is actually
some stuff that I was working I never
actually released it I was actually
looking at how to do similar things with
with OSX you don't have the autorun
capability but you can still trick
people one of the big vulnerabilities I
like to exploit is is greed and
stupidity but I found some things that
were really interesting in
that you know using AppleScript in a why
AppleScript why not objective-c first
I'm a shitty programmer and to Apple
script is trusted it actually has a lot
of interfaces with a lot of other
applications so you can if you're
targeting an apple system you know that
it's going to have iTunes and it has an
interface with this so I can then that's
what I'm going to leverage so one thing
I found too was that you know apples a
little tricky sorry it's kind of tiny
guys can't see that but I disguise the
the Trojan as a mp3 file what's
interesting with OSX is that if you try
to put a like a dot mp3 on a an app
it'll throw a tap at the end of it so
it's trying to help the user so that
they know that's an application so the
first rule was to try to trick that and
I've use what's called a homo glyph
so it basically trying to find a
character that looks like a period and
there's a little Turkish character
called an organic if you put that in
there instead it won't throw the dot app
on the end and it looks like it's a dot
mp3 and I have a demo of this too which
I'll try to do at the end if I have time
but then further you know you can
disguise the icon which is pretty simple
and I've actually put some of this code
up I'm going to go through some bits of
it so there's an object where you can
get system information there's also
another one you can get where you can
get all the applications that are
currently running which is cool you can
then write some scripts that will then
interface with those applications and
try to steal data but the biggest one
was I was trying to you know exfiltrate
data sure you can do things with shell
scripts and whatnot but sometimes I will
throw errors or alerts so what I did was
I just found a way to actually exit rate
data through iTunes so I will basically
grab all that data that I want and then
there's some some assurance coding that
I do it's included in the URL here on my
github page it's got the full script and
then I'll pass it out and through iTunes
so and then iTunes that actually will
stream in mp3 so you think you're
listening to some music while in the
background we're doing some bad stuff
what's neat too is that you can actually
do shell scripts from Apple script which
is great and I'm not sure if you guys
saw the you know the new Oh sexual owner
ability so I threw that in here just be
careful if you run that on your system
it's not on the one on get
but still review the code please I don't
want to get in trouble so so you know
USB is still a still an attack vector
you know still a threat
you know we saw that with Stuxnet we've
seen it with USB malware that even hit
the international space station more
recently we saw some US power plants
that actually had were infiltrated with
employee accidentally bringing in
infected USB sticks again a lot of those
systems are still running vulnerable
versions of Windows XP which I think
pretty much all of them are vulnerable
now and also we just saw this here again
a black hat so you know it still still
is a threat so kind of moving on you
know IP address you know that's that's a
one piece of information but a lot of
times you're going to need a lot of
other data this is a crazy wall you guys
seen this in like all the CSI shows
right when you're trying to track a
murder they have all the evidence and
they put these lines right
and that's kind of the thought process
that I follow as well tools that
actually make this a lot easier nowadays
are like multigo it automates a lot of
that process so I'm not sure if you ever
used it but it's a pretty great tool and
you can actually write all the custom
transforms to do a lot of this work but
basically I had a case where I was
tracking a flash drive just to give you
an example and you know we were able to
get the initial IP address and it was a
weird username to it wasn't something
they would actually identify a person
and we mapped it to it in AT&T;
subscriber but you know AT&T; that's
going to take like three months to track
it down and the flash drive was from a
professor and he had some research data
on it but it was still hard to convince
law enforcement to spend their resources
to go out and actually track this down
so but we did starting any connections
from a university and a specific
computer lab so that was useful because
we also get the internal network
information which is useful so we went
to the University IT department and
their campus security and we found that
yeah so we got a timestamp we have an
internal address but these are guest
computers so there wasn't actually a
student ID when you log in so we're
still not able to get the specific
person but I started asking questions
like what other data sources we have
here
and come to find out you have to swipe
your student ID card to get in and so
they have logs there right so we were
able to access those logs we tie that
with the timestamp now we have a list of
who's in the actual room add to that
they also a year before had a number of
lapped systems were actually stolen out
of that lab and so they actually had
cameras as well what's really cool is
that a lot of people don't realize that
a lot of these cameras when they
actually store the data there's also a
log file that gets generated so we were
able to correlate that timestamp as well
to identify who specifically was in that
room and they were able to use this
information found out who it was you
know had the professor as well as long
as well as the campus security outside
of the guy's classroom the next day and
he got his device back and all his
information was still there
yay so after working with us DB USB
devices I wanted to find ways of you
know looking at how to recover more
expensive vices like laptops you know I
looked at a lot of existing tools and
they relied heavily on the IP address
yeah which is and as I mentioned before
it takes a lot of time some of them
actually they'll utilize more invasive
techniques as well they'll actually open
up a backdoor into the system so they'll
have recovery teams that can deploy that
they can install key loggers and other
things like that which I found that to
be overly intrusive and I think in many
ways makes the system more vulnerable
there's a they also will put sometimes
put stuff in the firmware and muck with
that so there's a lot of lot of risks
and I found it you know we don't need to
go to that extreme I think there's other
ways of going about it and recovering
devices so I combined utilizing of the
web camera and you know with Wi-Fi based
geolocation there was a company that was
already doing the web camera on the Mac
but no one was utilizing Wi-Fi location
this is around when the first iPhone
came out and that's what it was using so
I worked with skyhook and it got that
deployed for this so we're able to get
look geolocation were able to camera
information so this was sort of a game
changer especially for law enforcement
there are some challenges with it so the
way it worked is that you would you
would activate tracking on a remote
server the device would check in to see
you know if it's been stolen if it's
been flagged if it's supposed to start
on gathering evidence
and there's a lot of different things
that would trigger that if it moved to a
new network if the IP address changed if
there was a login event so it was pretty
smart it would also note if it changed
location that it would also check in and
so it would then send information and at
the time I I didn't want to manage a
server especially with the photos and
things like that so we just had it go
directly into Flickr so you actually
register your Flickr account so that way
you have control of all your data you
don't have to worry about a third party
accessing your information or activating
your camera and spying on you I don't
trust myself
so whenever the laptop would connect it
would get the location from Wi-Fi it
would capture photos and it would do
this every 30 minutes and it would do it
very quickly so the green light it would
just be like a blip you wouldn't even
notice that was on so for the location i
use skyhook wireless was a great service
but now geolocation is embedded in all
the operating systems there's AP is for
it
you know and pretty much every major
order of both laptop as well as mobile
operating systems you can also get
location from the Google Maps API so
here's the kind of a call to how you how
to go about doing that so if you want to
write your own scripts to track your
devices that's a good way to a good way
to go
so the first recovery I had was actually
with this tool was in New York I had to
work with a New York police officer who
was kind of an a-hole he he was
basically saying he was really
frustrated cuz he had to he had to deal
with these types of tools before and
he's all pissed off because he's gonna
have deals paperwork and I'm like no
you're fine look so the location is
within 10 to 20 meters and he goes okay
well what's that what's that mean I
could just print out a photo of the guy
go to that location ask around and he's
like yeah don't tell me how to do my job
all right and but then anything he did
right and they go in and was this owner
of a tattoo parlor and if you look at
the photo in the background you're going
to see a lot of cool toys so there's a
nice big screen TV there's all sorts of
cool synthesizers all kinds of audio
equipment and so when the police finally
went in there they found the customers
it was an iMac
and they also found three laptops from
different cases and a lot of other
stolen property so this is one of those
examples where you trojan eyes an app
and then the Trojan app is sort of
unveils all these different crimes army
committed so you know at that one I said
we had a 300% recovery rate because the
other laptops were recovered so another
case we had was in Portland Oregon where
I live there was a group that was
repeatedly breaking into schools so they
were targeting a bunch of Portland
schools they would go in and they kept
stealing laptops what was really
frustrating was that they would do this
continuously they would go in they would
steal the laptops the the non-district
would go and replace those laptops a
week later these guys would come back in
and they would steal them again it was
like really it was like um it was like
four or five different schools that this
kept happening to so I approached him
and I say I said hey I got an idea so we
deployed the software to a bunch of bait
laptops and we left them out we didn't
even put them like in their locked
cabinets and just let him out there and
sure enough a week later if you think I
ripped off so we got the the network
information and this was a bit of a
challenge we're getting some photos and
we actually got it to a house that was
in Vancouver Washington so that's kind
of that's the next state over it's right
next to Portland and we got the location
to this one look one particular
neighborhood and again the locations
within 10 to 20 meters and so I told
them about this and gave the information
and the detective working on it so he
goes there and he thinks it's an exact
location he just goes to this one it's a
duplex and he goes to one side of it and
the guy that answers the door he knows
him it's the guy that works on his roof
and so he's all pissed off of me he's
like you guys don't know what the hell
you're doing so I was pissed off and so
I drove out there and I started actually
looking at the wireless I'm going to get
to see it but there's a little street
there and I pulled in and I pulled on my
laptop and I started looking at the
wireless networks in the area to make
sure that it was accurate and and sure
enough the thing is that there was a
wireless network that was called it was
Russia
and I look over and they're right next
to the guy on the other side of the
duplex there's a car and there's this
big like Russian pride bumper sticker on
the car and then I sorta I'm lookin in
there and then the girl comes out so you
start watching the car and then the guy
who we have a photo of walks out and I'm
like oh shit he looks at me and I I'm
like looking like I'm looking for
directions on my laptop right like I'm
lost but I called the detective and then
they came out and then finally they they
were able to continue the investigation
what's interest with this is that they
never actually told that the software
was involved in their case I was an
anonymous source and they ended up
arresting six to seven people that were
in this case it was an organized group
they were stealing a lot of other
property as well and some of them were
pretty bad dudes and they got them to
think that they'd all ratted on each
other so it was kind of cool so for some
reason there's a lot of sort of these
Russian guys that are involved in
stealing property in Oregon I was
involved in another case where the
laptop was stolen and we didn't get
anything for like two weeks I'm like oh
man they play like they reformat of the
hard drive or something right but you
know I tracked it and we started getting
a ping it in his early of all places and
I was like how the hell did that happen
right so we're getting this and there's
this guy named Victor and he it was nice
enough to change the user name on the
computer to his full name that was
really nice of him to do so he's he's
really trying to help us out but I had
photos of him everywhere the first one
we had was at you know he's in
McDonald's and at one point he was in a
hotel I was really shady and there's
like a girl behind him there's something
going on there but I was able to find
that yeah I found his myspace profile
and I was really noticed that he's
really into Sion he's a big car car nut
that's really into Scion if I found it
he has a bunch of posts on a lot of
different forums on Scion showing off
his car so that was helpful too because
then he gave me his license-plate number
and he's also a big eBay seller so he
was selling uh he had a store he was
selling all kinds of car parts so you
can kind of tell what kind of business
he's involved in and then he was nice -
well not so nice because he sold the
stolen laptop to his friend and Omar as
well as a stolen bike and what happened
here is that when the police actually
went in this is the first time we worked
the district attorney said you guys have
given us enough evidence that even if he
doesn't have the laptop we can bust him
for possession of stolen property so
that was kind of interesting were sort
of like making case law but they what
was happening is that there's a Russian
group that was here in Portland they
would steal a bunch of property they
would load it into this big white van
and there's another Russian group in
Missouri and they would swap stolen
property because where's the first place
you're going to look when your laptop
gets stolen Craigslist right so they're
kind of smart there but not that smart
we got him oh yeah a victor - yeah it
was actually his dad who was involved in
the one so it was a birthday present so
his dad nice guy gave him a stolen
laptop for his birthday and now he has a
criminal record thanks dad there was
another case where he had a I was in
Brazil so it's not just in the US this
was a little bit of a challenging
actually a little bit challenging
working with the Brazilian police but
there was a couple guys that were in
their car and these guys came out with
guns and you know said get out of the
car and then the driver they punched him
in the face knocked to the ground and
they kicked him he had like broken ribs
and a broken nose and then a guy who
actually installed my software he had
left his laptop it was still in the back
so we started getting pings and then the
police were actually really excited
about this because they were I guess
they did quite this quite a bit right so
they were assaulting a lot of other
people as well and stole a lot of
vehicles but just a good example of you
know how this can work internationally
as well it doesn't just have to be the
u.s. sometimes it depends on law
enforcement how willing they are to help
out but there's there's ways of
convincing them and here's the customer
with his his laptop back
he was a veterinary student too he just
finished his dissertation and he didn't
have it backed up so he was really happy
to get it back so then I also moved on
to mobile so mobile is a little
challenging because you know geolocation
is easier because it was already I'm in
the device itself but IP addresses
becomes much more problematic we also
wanted to we found that people really
don't care so much about the devices the
data so we built a system for backing up
photo and contact information and I was
really concerned about actually doing
that like storing people's photos on a
server you know first of all if we get
hacked and someone accesses all of our
customers photos that could be really
bad or you know the contact information
as well we saw this with the fappening
right that the risks that are associated
with that and so we built a system so
that when you you actually install the
app you enter a key a privacy key so
it'll actually encrypts your images and
your contact information before it sends
it to the server I like this too because
you know if we do get hacked you know we
were there data's still protected also
of law enforcement comes to us and they
want you know information yeah here you
go the big encrypted blob and they have
to go to the customer to get that that
key so and then you can also do the data
wipe and things like that so I built
this tool and and I have a little bit of
a video here to walk through one of the
cases so hopefully the video works
that's helping track them down News
Channel eight site each out spent the
past two days with police and
investigators on the trail of swiped
cellphones he's live outside the
Washington Square Mall where the theft
took place at well the managers of the
Sprint store here at the Washington
Square Mall behind me say they're very
confident that tracking software
developed only miles away from here and
put onto their demo phones will lead to
an arrest
this is a $500 phone this ended up being
a four hundred and fifty dollar fund to
empty display cradles are all that
remains after someone stole 2 demo
cellphones from the Sprint store at
Washington Square Mall on Saturday
moments after surveillance video caught
the theft on
eight employees initiated tracking
software installed on the stolen phones
they were able to not only find the GPS
location of the individuals that took
them but also we've been able to to
monitor any activity that happens in the
phone that activity turned out to be
pictures
someone took shortly after the phones
were stolen Tigard police admit it's a
brave new world when pictures taken on
cell phones can be told to send back
pictures once they're stolen and that
has not only piqued the interest of our
investigators but in essence appears at
this point could be very credible
information for us to follow up on the
Portland creator of the software
tracking the theft says police are on
the right track if they're not the
thieves I definitely know who stole it
and if you look over the head of this
man you'll see in the window an Oregon
temporary permit Phillip this is ed with
the help of a gadgettrak investigator on
the phone we track the stolen phone
signal to this Vancouver apartment
complex there we found the exact
temporary permit and hi young woman who
told us off camera a man she called
Peter and sent this photo to her
Saturday evening but says she knew
nothing about the phones hi my name is
Eddie tracked the second cellphone
signal to this duplex about eight blocks
away
you don't have an Samsung Epic phone
into this location thank you for here
yesterday looking for it we're back live
an outside the Washington Square Mall
where we've just obtained within the
hour
those DMV records on that temporary
permit tiger police say they hope the
men in the pictures will contact them
soon so they can explain how their faces
ended up on a stolen cell phone back to
you Thank You Eddie teach out the
contractors thanks thank you
so you know this helpful you know we got
we had you know the footage again kind
of like let's lock them out with the
other than the video camera footage
that's helpful you actually see when
they get caught it we have some
challenges with some of these devices
because the the for some reason the GPS
coordinates were with our software
that's access and it wasn't right but
luckily the photos that they took of
themselves did have the GPS coordinates
embedded in it and we had a timestamp as
well so they're really helpful as I
mentioned you know stupidity is one of
the better vulnerabilities that helps us
out quite a bit you know we were able to
get the location from that as well and
of course the trip permit you know
that's just it's just ridiculous but
they ended up getting these guys and
they again they ended up there was five
guys that were involved in this and
they're actually stealing my other
property one of these guys actually had
a warrant out for his arrest already and
they also in the process of
investigating this they also recovered a
stolen car so and so what I learn from
this too is I started looking at you
know the data that's actually embedded
in the images where it's really helpful
so there's a lot of metadata that's
actually embedded in it a lot of you're
probably familiar with it embeds GPS
coordinates it has a timestamp and I
also started looking at high-end digital
cameras and I found a lot of them
actually will embed the make model and
serial number and a really good tool
here there's a URL for this called exif
tool if you want to mess with Mexico
right scripts to do this kind of work
you can do that I also have a tool
called exes can calm me where you can
upload an image and you can see what if
there's GPS coordinates or serial
numbers embedded in it you can do that
and one thing I found is that there's
several camera brands that actually will
embed that serial number and many of
them are you know high-end cameras so I
want to go out and see if I could oh you
know use this for tracking stolen
cameras and one thing I found too is I
had a reporter that actually got asked
me you know there was a thing about
celebrities getting them their nude
photos
and the exif data the media kept saying
yeah the phones were hacked but
actuality the exif data revealed that it
was actually multiple phones over the
course of several years so the odds of
it being one device that was hacked was
very slim so the point of compromise was
actually email was a guy named Chris
Chaney who was just guessing their
passwords now he's serving 10 years in
jail so I looked at like how can I use
this information there wasn't a way to
actually search for it you can search
for a serial number sometimes you'll see
something on Flickr but I was like I
want a database of this data where I can
actually go through and identify that so
I worked in an experiment with something
I was actually helping another startup
friend of mine they were doing this
thing called CP usage where it's you can
actually you know you give up your idle
computer time and they'll give you money
for utilizing that so a bunch of
computer labs universities we're using
this sort of like SETI at home but for
other projects right and then you as a
researcher could harness the power of
thousands of computers so we want to
experiment with this like I wanted to go
through and I wanted to mine Flickr so
the way that works is I wrote some
scripts to go out and hit the Flickr API
Flickr was very restrictive on the API
and how many calls you could make you so
trying to do that from one system and
trying to do it quickly they're going to
block you I actually talked with a
friend of mine who who they had some
issues they saw the data and they saw
the reports coming through their yahoo
and they're trying to figure out who
this was and use me but we so we we
basically were allowed we have about 200
computers at our disposal and we went
through and we mined all of Flickr it
took about about three weeks to a month
and was like four billion images so we
had this huge database and then I put it
out there in the media that this was
available and you know the way that it
works may I also mind 500 pics Panoramio
I found other ones like twit pic Twitter
and some other sites as well we started
harvesting some data from there so the
way that it was working is that we would
harvest this information and then you
can actually put in the serial number of
your camera and then it'll show back
results all the images that we found
so the idea is that if your camera was
stolen and then three months later you
see a photo getting uploaded to Flickr
you can go recover your camera and it
was just a proof of concept but it
worked
we actually are John Heller he saw this
service
he actually had a camera that was stolen
when he was on assignment for Getty
Images at the Egyptian theater he just
turned around basically $9,000 what the
camera gear is gone he's a contractor
you know he's not going to get that back
it's pretty pretty hurtful here but he
did a search you know and then he found
an image on Flickr that was you know
uploaded well after it was stolen and
that mapped to Facebook to another
professional photographer and he was had
a photo of all of his gear and there
sure enough was his camera
the LAPD got involved and what happened
was the thief he stole the camera from
him he then sold it on Craigslist and
then the guy that bought it from on
Craigslist had sold it on eBay so
someone the person actually had it had
no idea that it was actually stolen but
the police they went in there able to
recover it the guy who got it on eBay he
went to the seller and he was able to
get his money back
yay let the other guy not so much but
they win in a year after was stolen to
the apartment where the guy bought it on
Craigslist and they go in the guy was
still there and there was all kinds of
other stolen property so it's the first
recovery of its kind I think I've ever
seen like that you know here's the
report there but yeah he got arrested so
I had another case where a guy
Craigslist onion start calling it like
crime list or something because that
seems to be where all the stuff happens
he was selling a bunch of gear camera
gear before he moved and a guy came with
cash in his hand you want to take a look
at this camera that he was selling takes
him out to the garage shows in the box
the guy just pops someone knocks him to
the ground and runs off so he actually
found images that were mapped to it I am
just helping with with this we got a lot
of information about this guy and all
the other photos that he was uploading
to other social media websites as well
and
he was doing some pretty interesting
things you know taking photos of
themselves smoking weed driving down the
freeway
you know photo of himself with a gun
showing how hardcore he is and he also
took a photo of his speedometer going
110 miles an hour down the freeway well
smokin dope and we had the timestamp
geolocation and everything so law
enforcement really liked that
vulnerability stupidity and this tool is
actually also used by ice so they're
really interested in using this in the
Child Exploitation Investigations Unit
so they do some really cool work where a
lot of these guys that are actually
victimizing children there's some sick
forms out there where they'll actually
be giving each other advice no actually
upload photos of hey this there's this
young girl I have in my car and they can
actually look at some of the images the
ice guys like a road sign or something
like that they look for some indicators
that they can go and try to stop this
before anything happens and so they were
actually utilizing this tool as well so
the idea is that you know Joe pervert is
he's uploading child porn and maybe he's
using the same camera when he goes to
Disneyland takes photos with his family
so if you get a serial number of one of
these images innocent images what they
call and you map that in court like that
with a camera on flickr for example that
can help them ID a suspect i'm not sure
if it was actually every user for
cottony buddy they couldn't tell me but
i thought it was kind of a cool
application of it so basically I learned
a lot is like you know a lot of pieces
of information out there that can be
used to identify that suspect this is a
Edmond Locard
and he's sort of the the grandfather of
forensic science and he has this college
thing called Locard's exchange principle
that every contact leaves a trace of
course he was talking about physical
crimes like when you go commit a crime
you actually bring something with you
and you leave something behind and so I
believe that actually carries over into
the digital world as well for my
experience you know we have all these
pieces of data
you know IP addresses I get really
worried about all these different
breaches that are happening
you know we have all these data points
and when we start to correlate them we
can actually start we created a rich
profile of an individual and then we
talked about ended of things and all the
different places where we can find those
indicators from device IDs things that
we may not even think about right now
could they can identify us
the technology can exist a year from now
that will actually allow us to mine that
and identify us identify us and I talked
about interaction of things you know
there's there's data that's created by
us that we're aware of there's data
created for us that we may not be aware
of there's also data created about us
that correlates all this information so
I really worry about the marketing
groups in particular and then what I
call boogie data so a lot of people
don't realize when you send an SMS
message for example you delete it the
other person deletes it but the problem
is there's 20 log files that get
generated at least through the carrier
right so there's always a trace
somewhere of this information or we talk
about like Ashley Madison things like
that where we think are our privacy is
being protected when it in actuality
it's not so I call this buggy data
because it's information that's out
there and it's it can come back and
haunt us later maybe it's going to hit
us really hard I've been working with a
group privacy century they have an
application called spyware copy and it's
actually looking at applications that
are accessing your location and sending
that information
we've been doing some really interesting
research here identifying some very
popular applications that are actually
gathering location your imei maasai and
setting it to servers in China for
example and that's it for my talk here
if you guys have questions feel free to
reach out to me on Twitter or on my
email do we have more time like 5
minutes ok I'm going to do a quick demo
let's see if this works
demo gods all right so here's the the
Mac Trojan you guys ready so here you
see it says like dot app here's another
one that's an mp3 if I double click on
this if the network connection works we
should see a seed in action
hi guys
